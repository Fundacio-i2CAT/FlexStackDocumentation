

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Getting Started &mdash; FlexStack 0.9.6 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=7430def1"></script>
      <script src="_static/doctools.js?v=888ff710"></script>
      <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="FlexStack Architecture" href="architecture.html" />
    <link rel="prev" title="Overview" href="overview.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            FlexStack
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">FlexStack(R) Overview</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview.html#modules">Modules</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-the-example">Setting up the example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#logging">Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#location-service">Location Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="#link-layer">Link Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#geonetworking">GeoNetworking</a></li>
<li class="toctree-l3"><a class="reference internal" href="#btp">BTP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#facilities-layer">Facilities Layer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#complete-script">Complete Script</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">FlexStack Architecture</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FlexStack(R) Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules/link_layer.html">Link Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/geonetworking.html">GeoNetworking (GN)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modules/geonetworking.html#diagram">Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules/geonetworking.html#usage">Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modules/geonetworking.html#router-instantiation">Router Instantiation</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/geonetworking.html#request-sending-geonetworking-packet">Request Sending GeoNetworking Packet</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/geonetworking.html#receiving-geonetworking-packet">Receiving GeoNetworking Packet</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules/security.html">Security Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/btp.html">Basic Transport Protocol (BTP)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modules/btp.html#diagram">Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules/btp.html#usage">Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modules/btp.html#router-instantiation">Router Instantiation</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/btp.html#request-sending-btp-packet">Request Sending BTP Packet</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/btp.html#response-receiving-btp-packet">Response Receiving BTP Packet</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modules/btp.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules/applications.html">Applications Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/utils.html">Utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Facilities Services</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules/facilities/ca_basic_service.html">Cooperative Awareness (CA) Basic Service</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modules/facilities/ca_basic_service.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules/facilities/ca_basic_service.html#diagram">Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules/facilities/ca_basic_service.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules/facilities/ca_basic_service.html#basic-script-sending-and-receiving-cams">Basic Script sending and receiving CAMs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules/facilities/vru_awareness_service.html">VRU Awareness Service</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modules/facilities/vru_awareness_service.html#vru-awareness-messages-overview">VRU Awareness Messages Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/vru_awareness_service.html#vru-basic-service-management">VRU Basic Service Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/vru_awareness_service.html#vru-cluster-management">VRU Cluster Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/vru_awareness_service.html#vam-reception-management">VAM Reception Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/vru_awareness_service.html#vam-transmission-management">VAM Transmission Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/vru_awareness_service.html#vam-encoding-decoding">VAM Encoding &amp; Decoding</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modules/facilities/vru_awareness_service.html#quickstart">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules/facilities/vru_awareness_service.html#interfacing-with-the-vru-basic-service">Interfacing with the VRU Basic Service</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules/facilities/den_service.html">Decentralized Environmental Notification (DEN) Service</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modules/facilities/den_service.html#denm-overview">DENM Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/den_service.html#den-service">DEN Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/den_service.html#den-reception-management">DEN Reception Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/den_service.html#den-transmission-management">DEN Transmission Management</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modules/facilities/den_service.html#application-layer-emergency-vehicle-approaching-service">Application Layer: Emergency Vehicle Approaching Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules/facilities/den_service.html#quickstart">Quickstart</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules/facilities/local_dynamic_map.html">Local Dynamic Map</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modules/facilities/local_dynamic_map.html#local-dynamic-map-overview">Local Dynamic Map Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/local_dynamic_map.html#local-dynamic-map-service">Local Dynamic Map Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/local_dynamic_map.html#local-dynamic-map-maintenance">Local Dynamic Map Maintenance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modules/facilities/local_dynamic_map.html#ldm-declaration">LDM Declaration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/local_dynamic_map.html#ldm-data-providers">LDM Data Providers</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/local_dynamic_map.html#ldm-data-consumers">LDM Data Consumers</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/local_dynamic_map.html#ldm-data-object">LDM Data Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/local_dynamic_map.html#ldm-area-of-maintenance">LDM Area of Maintenance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modules/facilities/local_dynamic_map.html#local-dynamic-map-interfacing-options">Local Dynamic Map Interfacing Options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/local_dynamic_map.html#ldm-publish-interface">LDM Publish Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/local_dynamic_map.html#ldm-query-interface">LDM Query Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/facilities/local_dynamic_map.html#ldm-publish-subscribe-interface">LDM Publish/Subscribe Interface</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modules/facilities/local_dynamic_map.html#quickstart">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules/facilities/local_dynamic_map.html#interfacing-with-the-vru-basic-service">Interfacing with the VRU Basic Service</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules/tutorials/docker-deployment.html">Docker Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/tutorials/rawlinklayer-ethernet-deployment.html">Sending and Recieving V2X Messages Through Ethernet</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/tutorials/logging.html">Logging</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modules/tutorials/logging.html#logging-configuration">Logging Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modules/tutorials/logging.html#simple-configuration-logging">Simple Configuration Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/tutorials/logging.html#file-configuration-logging">File Configuration Logging</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">FlexStack</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Getting Started</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/getting_started.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this heading"></a></h1>
<p>The flexStack(R) library was designed to be easy to use and to facilitate the development of V2X applications. This section will guide you through the process of setting up the library and running a simple example.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h2>
<p>The library can be easily installed using the <cite>pip</cite> command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>v2xflexstack
</pre></div>
</div>
<p>This will automatically install the library and all its dependencies.</p>
<p>The library has been coded for python versions above 3.8.</p>
</section>
<section id="setting-up-the-example">
<h2>Setting up the example<a class="headerlink" href="#setting-up-the-example" title="Permalink to this heading"></a></h2>
<p>Usually the most basic use case behind anyone learning V2X, and more specifically the ETSI C-ITS standards, is
the so-called Cooperative Awareness Use Case. Which relies on the dissemination and reception of Cooperative Awareness Messages (CAMs).</p>
<p>CAMs disseminate the basic information of a vehicle, such as its position, speed, heading, and other relevant information.
This information can then be used by other vehicles to make decisions, such as collision avoidance or even cooperative maneuvers.</p>
<p>To be able to do that, there will be needed the instantiation of the whole protocol stack. From a the lowest levels, to GeoNetworking and BTP
on the Network and Transport layers, to the Facilities Layer.</p>
<p>For more information on each module that will be used, please refer to their reference documentation.</p>
<p>The following lines will guide you through the instantiation of the whole protocol stack, and the instantiation of a Cooperative Awareness Basic Service.</p>
<p>The idea behind this tutorial is for the reader to following it by copying and pasting the code snippets into a Python script.
Understanding that the importing code snippets will be copied at the beggining of the script, and the instantiation code snippets will be copied in the main body of the script.</p>
<section id="logging">
<h3>Logging<a class="headerlink" href="#logging" title="Permalink to this heading"></a></h3>
<p>FlexStack(R) modules use the Python logging module to log messages. To enable logging, you can use the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="location-service">
<h3>Location Service<a class="headerlink" href="#location-service" title="Permalink to this heading"></a></h3>
<p>The ETSI C-ITS protocol stack requires the knowledge of the node’s position. To do so, there can be instantiated the so-called
<cite>LocationService`s. Which provide periodical position updates to all protocols. The FlexStack(R) comes with the `GPSDLocationService</cite>
which gets the position from a GPSD service or, in this tutorial, for simplicity reasons, an static location service will be used.</p>
<p>To import the static location service:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.utils.static_location_service</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThreadStaticLocationService</span>
</pre></div>
</div>
<p>This <cite>LocationService</cite> feeds a fixed GPS position to all modules getting position from it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">POSITION_COORDINATES</span> <span class="o">=</span> <span class="p">[</span><span class="mf">41.386931</span><span class="p">,</span> <span class="mf">2.112104</span><span class="p">]</span>
<span class="n">location_service</span> <span class="o">=</span> <span class="n">ThreadStaticLocationService</span><span class="p">(</span>
    <span class="n">period</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="n">POSITION_COORDINATES</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">longitude</span><span class="o">=</span><span class="n">POSITION_COORDINATES</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="link-layer">
<h3>Link Layer<a class="headerlink" href="#link-layer" title="Permalink to this heading"></a></h3>
<p>The Access and Physical Layer of the ETSI C-ITS protocol stack can be instantiated with the so-called <cite>LinkLayer`s.
Which either connect to the hardware enabling ITS G5 or C-V2X communications or other network infrastructure for testing purposes.
If there is the appropriate hardware there can be instantiated the `PythonCV2XLinkLayer</cite> to use C-V2X. But in the present tutorial
there will be used the <cite>RawLinkLayer</cite> that opens a Linux Layer 2 socket to send and receive packets.</p>
<p>To import the raw link layer:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.linklayer.raw_link_layer</span><span class="w"> </span><span class="kn">import</span> <span class="n">RawLinkLayer</span>
</pre></div>
</div>
<p>Then to instantiate it there can be used the following code snippet:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mac_address</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xaa\xbb\xcc\x11\x21\x11</span><span class="s2">&quot;</span>
<span class="n">link_layer</span> <span class="o">=</span> <span class="n">RawLinkLayer</span><span class="p">(</span>
    <span class="s2">&quot;lo&quot;</span><span class="p">,</span> <span class="n">mac_address</span><span class="p">,</span> <span class="n">receive_callback</span><span class="o">=</span><span class="n">gn_router</span><span class="o">.</span><span class="n">gn_data_indicate</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The <cite>“lo”</cite> parameter is the Linux layer 2 interface on which the messages will be sent/received. There MAC address also has to be configured.</p>
</section>
<section id="geonetworking">
<h3>GeoNetworking<a class="headerlink" href="#geonetworking" title="Permalink to this heading"></a></h3>
<p>The GeoNetworking (GN) protocol is one of the main pillars of the ETSI C-ITS protocol stack. To instantiate it, there just have to be
configured a few parameters and then use it’s router.</p>
<p>The following imports must be present:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.geonet.router</span><span class="w"> </span><span class="kn">import</span> <span class="n">Router</span> <span class="k">as</span> <span class="n">GNRouter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.geonet.mib</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIB</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.geonet.gn_address</span><span class="w"> </span><span class="kn">import</span> <span class="n">GNAddress</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">ST</span><span class="p">,</span> <span class="n">MID</span>
</pre></div>
</div>
<p>The <cite>MIB</cite> object must be configured to instantiate the GN Router. Basically it has to be aligned with the pre-configured <cite>mac_address</cite>.
And there are a few more parameters in the GN address that should also be configured.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mib</span> <span class="o">=</span> <span class="n">MIB</span><span class="p">()</span>
<span class="n">gn_addr</span> <span class="o">=</span> <span class="n">GNAddress</span><span class="p">()</span>
<span class="n">gn_addr</span><span class="o">.</span><span class="n">set_m</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">GN_MULTICAST</span><span class="p">)</span>
<span class="n">gn_addr</span><span class="o">.</span><span class="n">set_st</span><span class="p">(</span><span class="n">ST</span><span class="o">.</span><span class="n">CYCLIST</span><span class="p">)</span>
<span class="n">gn_addr</span><span class="o">.</span><span class="n">set_mid</span><span class="p">(</span><span class="n">MID</span><span class="p">(</span><span class="n">mac_address</span><span class="p">))</span>
<span class="n">mib</span><span class="o">.</span><span class="n">itsGnLocalGnAddr</span> <span class="o">=</span> <span class="n">gn_addr</span>
<span class="n">gn_router</span> <span class="o">=</span> <span class="n">GNRouter</span><span class="p">(</span><span class="n">mib</span><span class="o">=</span><span class="n">mib</span><span class="p">,</span> <span class="n">sign_service</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">location_service</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">gn_router</span><span class="o">.</span><span class="n">refresh_ego_position_vector</span><span class="p">)</span>
<span class="n">gn_router</span><span class="o">.</span><span class="n">link_layer</span> <span class="o">=</span> <span class="n">link_layer</span>
</pre></div>
</div>
<p>It’s important to remark that both the location service and the link layer previously instantiated must be
connected to the GN Router; as it can be seen in the last two code lines.</p>
</section>
<section id="btp">
<h3>BTP<a class="headerlink" href="#btp" title="Permalink to this heading"></a></h3>
<p>The BTP protocol works as a transport protocol multiplexing all received GN messages to the right service/application.</p>
<p>There is enough with importing the router:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.btp.router</span><span class="w"> </span><span class="kn">import</span> <span class="n">Router</span> <span class="k">as</span> <span class="n">BTPRouter</span>
</pre></div>
</div>
<p>Then to instantiate the BTP Router there is enough with instantiating it and connecting it to the BTP router:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">btp_router</span> <span class="o">=</span> <span class="n">BTPRouter</span><span class="p">(</span><span class="n">gn_router</span><span class="p">)</span>
<span class="n">gn_router</span><span class="o">.</span><span class="n">register_indication_callback</span><span class="p">(</span><span class="n">btp_router</span><span class="o">.</span><span class="n">btp_data_indication</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="facilities-layer">
<h3>Facilities Layer<a class="headerlink" href="#facilities-layer" title="Permalink to this heading"></a></h3>
<p>There are two services mandatory to enable a Cooperative Awareness use case: The CA Basic Service itself and the Local Dynamic Map</p>
<section id="local-dynamic-map">
<h4>Local Dynamic Map<a class="headerlink" href="#local-dynamic-map" title="Permalink to this heading"></a></h4>
<p>The Local Dynamic Map is the most complex and necessary facilities layer service. It basically
collects all of the data coming from all facilities services to then serve this data to possible applications
in the application layer.</p>
<p>To instantiate it and give it a callback that will be called when a message is received the following modules should
be imported:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.facilities.local_dynamic_map.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">ldm_factory</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.facilities.local_dynamic_map.ldm_classes</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Location</span><span class="p">,</span>
    <span class="n">SubscribeDataobjectsReq</span><span class="p">,</span>
    <span class="n">SubscribeDataObjectsResp</span><span class="p">,</span>
    <span class="n">RegisterDataConsumerReq</span><span class="p">,</span>
    <span class="n">RegisterDataConsumerResp</span><span class="p">,</span>
    <span class="n">RequestDataObjectsResp</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.facilities.local_dynamic_map.ldm_constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">CAM</span>
</pre></div>
</div>
<p>The following code initializes a Local Dynamic Map and creates a callback function called <cite>ldm_subscription_callback</cite>
which will be called periodically reporting all the received and cached CAM messages:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiate a Local Dynamic Map (LDM)</span>
<span class="n">ldm</span> <span class="o">=</span> <span class="n">ldm_factory</span><span class="p">(</span>
    <span class="n">Location</span><span class="o">.</span><span class="n">initializer</span><span class="p">(),</span>
    <span class="n">ldm_maintenance_type</span><span class="o">=</span><span class="s2">&quot;Reactive&quot;</span><span class="p">,</span>
    <span class="n">ldm_service_type</span><span class="o">=</span><span class="s2">&quot;Reactive&quot;</span><span class="p">,</span>
    <span class="n">ldm_database_type</span><span class="o">=</span><span class="s2">&quot;Dictionary&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">location_service</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">ldm_location</span><span class="o">.</span><span class="n">location_service_callback</span><span class="p">)</span>

<span class="c1"># Subscribe to LDM</span>
<span class="n">register_data_consumer_reponse</span><span class="p">:</span> <span class="n">RegisterDataConsumerResp</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ldm</span><span class="o">.</span><span class="n">if_ldm_4</span><span class="o">.</span><span class="n">register_data_consumer</span><span class="p">(</span>
        <span class="n">RegisterDataConsumerReq</span><span class="p">(</span>
            <span class="n">application_id</span><span class="o">=</span><span class="n">CAM</span><span class="p">,</span>
            <span class="n">access_permisions</span><span class="o">=</span><span class="p">[</span><span class="n">CAM</span><span class="p">],</span>
            <span class="n">area_of_interest</span><span class="o">=</span><span class="n">ldm_location</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="k">if</span> <span class="n">register_data_consumer_reponse</span><span class="o">.</span><span class="n">result</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">ldm_subscription_callback</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">RequestDataObjectsResp</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># We are printing any received CAM message.</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">data_objects</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;dataObject&quot;</span><span class="p">][</span><span class="s2">&quot;header&quot;</span><span class="p">][</span><span class="s2">&quot;stationId&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">data_objects</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;dataObject&quot;</span><span class="p">][</span><span class="s2">&quot;header&quot;</span><span class="p">][</span><span class="s2">&quot;stationId&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">station_id</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Received CAM from : </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">data_objects</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;dataObject&quot;</span><span class="p">][</span><span class="s2">&quot;header&quot;</span><span class="p">][</span><span class="s2">&quot;stationId&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>


<span class="n">subscribe_data_consumer_response</span><span class="p">:</span> <span class="n">SubscribeDataObjectsResp</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ldm</span><span class="o">.</span><span class="n">if_ldm_4</span><span class="o">.</span><span class="n">subscribe_data_consumer</span><span class="p">(</span>
        <span class="n">SubscribeDataobjectsReq</span><span class="p">(</span>
            <span class="n">application_id</span><span class="o">=</span><span class="n">CAM</span><span class="p">,</span>
            <span class="n">data_object_type</span><span class="o">=</span><span class="p">[</span><span class="n">CAM</span><span class="p">],</span>
            <span class="n">priority</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">notify_time</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">multiplicity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">ldm_subscription_callback</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="k">if</span> <span class="n">subscribe_data_consumer_response</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">result</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="ca-basic-service">
<h4>CA Basic Service<a class="headerlink" href="#ca-basic-service" title="Permalink to this heading"></a></h4>
<p>Finally the Cooperative Awareness (CA) Basic Service itself. Which sends and receives the CAM messages.</p>
<p>To import it there is enough with importing the service and the VehicleData class which works to configure the
service.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.facilities.ca_basic_service.ca_basic_service</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">CooperativeAwarenessBasicService</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.facilities.ca_basic_service.cam_transmission_management</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">VehicleData</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Finally, the CA Basic service configuration and instantiation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiate a CA Basic Service</span>
<span class="n">vehicle_data</span> <span class="o">=</span> <span class="n">VehicleData</span><span class="p">()</span>
<span class="n">vehicle_data</span><span class="o">.</span><span class="n">station_id</span> <span class="o">=</span> <span class="n">station_id</span>  <span class="c1"># Station Id of the ITS PDU Header</span>
<span class="n">vehicle_data</span><span class="o">.</span><span class="n">station_type</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Station Type as specified in ETSI TS 102 894-2 V2.3.1 (2024-08)</span>
<span class="n">vehicle_data</span><span class="o">.</span><span class="n">drive_direction</span> <span class="o">=</span> <span class="s2">&quot;forward&quot;</span>
<span class="n">vehicle_data</span><span class="o">.</span><span class="n">vehicle_length</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;vehicleLengthValue&quot;</span><span class="p">:</span> <span class="mi">1023</span><span class="p">,</span>  <span class="c1"># as specified in ETSI TS 102 894-2 V2.3.1 (2024-08)</span>
    <span class="s2">&quot;vehicleLengthConfidenceIndication&quot;</span><span class="p">:</span> <span class="s2">&quot;unavailable&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">vehicle_data</span><span class="o">.</span><span class="n">vehicle_width</span> <span class="o">=</span> <span class="mi">62</span>

<span class="n">ca_basic_service</span> <span class="o">=</span> <span class="n">CooperativeAwarenessBasicService</span><span class="p">(</span>
    <span class="n">btp_router</span><span class="o">=</span><span class="n">btp_router</span><span class="p">,</span>
    <span class="n">vehicle_data</span><span class="o">=</span><span class="n">vehicle_data</span><span class="p">,</span>
    <span class="n">ldm</span><span class="o">=</span><span class="n">ldm</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">location_service</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">ca_basic_service</span><span class="o">.</span><span class="n">cam_transmission_management</span><span class="o">.</span><span class="n">location_service_callback</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, to make sure the script keeps working unless stopped, there is enough with the following lines:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Press Ctrl+C to stop the program.&quot;</span><span class="p">)</span>
<span class="n">location_service</span><span class="o">.</span><span class="n">location_service_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="complete-script">
<h2>Complete Script<a class="headerlink" href="#complete-script" title="Permalink to this heading"></a></h2>
<p>The whole script can be found below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configure logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

<span class="c1"># Link Layer Imports</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.linklayer.raw_link_layer</span><span class="w"> </span><span class="kn">import</span> <span class="n">RawLinkLayer</span>

<span class="c1"># GeoNetworking imports</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.geonet.router</span><span class="w"> </span><span class="kn">import</span> <span class="n">Router</span> <span class="k">as</span> <span class="n">GNRouter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.geonet.mib</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIB</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.geonet.gn_address</span><span class="w"> </span><span class="kn">import</span> <span class="n">GNAddress</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">ST</span><span class="p">,</span> <span class="n">MID</span>

<span class="c1"># BTP Router imports</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.btp.router</span><span class="w"> </span><span class="kn">import</span> <span class="n">Router</span> <span class="k">as</span> <span class="n">BTPRouter</span>

<span class="c1"># Location Service imports</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.utils.static_location_service</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThreadStaticLocationService</span>

<span class="c1"># Local Dynamic Map imports</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.facilities.local_dynamic_map.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">ldm_factory</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.facilities.local_dynamic_map.ldm_classes</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Location</span><span class="p">,</span>
    <span class="n">SubscribeDataobjectsReq</span><span class="p">,</span>
    <span class="n">SubscribeDataObjectsResp</span><span class="p">,</span>
    <span class="n">RegisterDataConsumerReq</span><span class="p">,</span>
    <span class="n">RegisterDataConsumerResp</span><span class="p">,</span>
    <span class="n">RequestDataObjectsResp</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.facilities.local_dynamic_map.ldm_constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">CAM</span>

<span class="c1"># CA Basic Service imports</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.facilities.ca_basic_service.ca_basic_service</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">CooperativeAwarenessBasicService</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flexstack.facilities.ca_basic_service.cam_transmission_management</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">VehicleData</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Basic Configuration Parameters</span>
<span class="n">POSITION_COORDINATES</span> <span class="o">=</span> <span class="p">[</span><span class="mf">41.386931</span><span class="p">,</span> <span class="mf">2.112104</span><span class="p">]</span>
<span class="n">mac_address</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xaa\xbb\xcc\x11\x21\x11</span><span class="s2">&quot;</span>
<span class="n">station_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mac_address</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Instantiate a Location Service</span>
<span class="n">location_service</span> <span class="o">=</span> <span class="n">ThreadStaticLocationService</span><span class="p">(</span>
    <span class="n">period</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="n">POSITION_COORDINATES</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">longitude</span><span class="o">=</span><span class="n">POSITION_COORDINATES</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Instantiate a Link Layer</span>
<span class="n">link_layer</span> <span class="o">=</span> <span class="n">RawLinkLayer</span><span class="p">(</span>
    <span class="s2">&quot;lo&quot;</span><span class="p">,</span> <span class="n">mac_address</span><span class="p">,</span> <span class="n">receive_callback</span><span class="o">=</span><span class="n">gn_router</span><span class="o">.</span><span class="n">gn_data_indicate</span>
<span class="p">)</span>

<span class="c1"># Instantiate a GN router</span>
<span class="n">mib</span> <span class="o">=</span> <span class="n">MIB</span><span class="p">()</span>
<span class="n">gn_addr</span> <span class="o">=</span> <span class="n">GNAddress</span><span class="p">()</span>
<span class="n">gn_addr</span><span class="o">.</span><span class="n">set_m</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">GN_MULTICAST</span><span class="p">)</span>
<span class="n">gn_addr</span><span class="o">.</span><span class="n">set_st</span><span class="p">(</span><span class="n">ST</span><span class="o">.</span><span class="n">CYCLIST</span><span class="p">)</span>
<span class="n">gn_addr</span><span class="o">.</span><span class="n">set_mid</span><span class="p">(</span><span class="n">MID</span><span class="p">(</span><span class="n">mac_address</span><span class="p">))</span>
<span class="n">mib</span><span class="o">.</span><span class="n">itsGnLocalGnAddr</span> <span class="o">=</span> <span class="n">gn_addr</span>
<span class="n">gn_router</span> <span class="o">=</span> <span class="n">GNRouter</span><span class="p">(</span><span class="n">mib</span><span class="o">=</span><span class="n">mib</span><span class="p">,</span> <span class="n">sign_service</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">location_service</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">gn_router</span><span class="o">.</span><span class="n">refresh_ego_position_vector</span><span class="p">)</span>
<span class="n">gn_router</span><span class="o">.</span><span class="n">link_layer</span> <span class="o">=</span> <span class="n">link_layer</span>

<span class="c1"># Instantiate a BTP router</span>
<span class="n">btp_router</span> <span class="o">=</span> <span class="n">BTPRouter</span><span class="p">(</span><span class="n">gn_router</span><span class="p">)</span>
<span class="n">gn_router</span><span class="o">.</span><span class="n">register_indication_callback</span><span class="p">(</span><span class="n">btp_router</span><span class="o">.</span><span class="n">btp_data_indication</span><span class="p">)</span>

<span class="c1"># Instantiate a Local Dynamic Map (LDM)</span>
<span class="n">ldm_location</span> <span class="o">=</span> <span class="n">Location</span><span class="o">.</span><span class="n">initializer</span><span class="p">()</span>
<span class="n">ldm</span> <span class="o">=</span> <span class="n">ldm_factory</span><span class="p">(</span>
    <span class="n">ldm_location</span><span class="p">,</span>
    <span class="n">ldm_maintenance_type</span><span class="o">=</span><span class="s2">&quot;Reactive&quot;</span><span class="p">,</span>
    <span class="n">ldm_service_type</span><span class="o">=</span><span class="s2">&quot;Reactive&quot;</span><span class="p">,</span>
    <span class="n">ldm_database_type</span><span class="o">=</span><span class="s2">&quot;Dictionary&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">location_service</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">ldm_location</span><span class="o">.</span><span class="n">location_service_callback</span><span class="p">)</span>

<span class="c1"># Subscribe to LDM</span>
<span class="n">register_data_consumer_reponse</span><span class="p">:</span> <span class="n">RegisterDataConsumerResp</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ldm</span><span class="o">.</span><span class="n">if_ldm_4</span><span class="o">.</span><span class="n">register_data_consumer</span><span class="p">(</span>
        <span class="n">RegisterDataConsumerReq</span><span class="p">(</span>
            <span class="n">application_id</span><span class="o">=</span><span class="n">CAM</span><span class="p">,</span>
            <span class="n">access_permisions</span><span class="o">=</span><span class="p">[</span><span class="n">CAM</span><span class="p">],</span>
            <span class="n">area_of_interest</span><span class="o">=</span><span class="n">ldm_location</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="k">if</span> <span class="n">register_data_consumer_reponse</span><span class="o">.</span><span class="n">result</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">ldm_subscription_callback</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">RequestDataObjectsResp</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># We are printing any received CAM message.</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">data_objects</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;dataObject&quot;</span><span class="p">][</span><span class="s2">&quot;header&quot;</span><span class="p">][</span><span class="s2">&quot;stationId&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">data_objects</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;dataObject&quot;</span><span class="p">][</span><span class="s2">&quot;header&quot;</span><span class="p">][</span><span class="s2">&quot;stationId&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">station_id</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Received CAM from : </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">data_objects</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;dataObject&quot;</span><span class="p">][</span><span class="s2">&quot;header&quot;</span><span class="p">][</span><span class="s2">&quot;stationId&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>


<span class="n">subscribe_data_consumer_response</span><span class="p">:</span> <span class="n">SubscribeDataObjectsResp</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ldm</span><span class="o">.</span><span class="n">if_ldm_4</span><span class="o">.</span><span class="n">subscribe_data_consumer</span><span class="p">(</span>
        <span class="n">SubscribeDataobjectsReq</span><span class="p">(</span>
            <span class="n">application_id</span><span class="o">=</span><span class="n">CAM</span><span class="p">,</span>
            <span class="n">data_object_type</span><span class="o">=</span><span class="p">[</span><span class="n">CAM</span><span class="p">],</span>
            <span class="n">priority</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">notify_time</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">multiplicity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">ldm_subscription_callback</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="k">if</span> <span class="n">subscribe_data_consumer_response</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">result</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Instantiate a CA Basic Service</span>
<span class="n">vehicle_data</span> <span class="o">=</span> <span class="n">VehicleData</span><span class="p">()</span>
<span class="n">vehicle_data</span><span class="o">.</span><span class="n">station_id</span> <span class="o">=</span> <span class="n">station_id</span>  <span class="c1"># Station Id of the ITS PDU Header</span>
<span class="n">vehicle_data</span><span class="o">.</span><span class="n">station_type</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Station Type as specified in ETSI TS 102 894-2 V2.3.1 (2024-08)</span>
<span class="n">vehicle_data</span><span class="o">.</span><span class="n">drive_direction</span> <span class="o">=</span> <span class="s2">&quot;forward&quot;</span>
<span class="n">vehicle_data</span><span class="o">.</span><span class="n">vehicle_length</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;vehicleLengthValue&quot;</span><span class="p">:</span> <span class="mi">1023</span><span class="p">,</span>  <span class="c1"># as specified in ETSI TS 102 894-2 V2.3.1 (2024-08)</span>
    <span class="s2">&quot;vehicleLengthConfidenceIndication&quot;</span><span class="p">:</span> <span class="s2">&quot;unavailable&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">vehicle_data</span><span class="o">.</span><span class="n">vehicle_width</span> <span class="o">=</span> <span class="mi">62</span>

<span class="n">ca_basic_service</span> <span class="o">=</span> <span class="n">CooperativeAwarenessBasicService</span><span class="p">(</span>
    <span class="n">btp_router</span><span class="o">=</span><span class="n">btp_router</span><span class="p">,</span>
    <span class="n">vehicle_data</span><span class="o">=</span><span class="n">vehicle_data</span><span class="p">,</span>
    <span class="n">ldm</span><span class="o">=</span><span class="n">ldm</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">location_service</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">ca_basic_service</span><span class="o">.</span><span class="n">cam_transmission_management</span><span class="o">.</span><span class="n">location_service_callback</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Press Ctrl+C to stop the program.&quot;</span><span class="p">)</span>
<span class="n">location_service</span><span class="o">.</span><span class="n">location_service_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="overview.html" class="btn btn-neutral float-left" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="architecture.html" class="btn btn-neutral float-right" title="FlexStack Architecture" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, i2CAT Foundation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>